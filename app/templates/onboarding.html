{% extends "base.html" %}

{% block title %}Create New Chat - Teacher's Class Assistant{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-10 xl:py-12">
  <!-- Header Section -->
  <div class="mb-8 text-center sm:text-left">
    <h1 class="text-3xl font-bold text-gray-900 mb-4">Generate Lesson Ideas and Practice Questions</h1>
  </div>

  <!-- Main Form Container -->
  <div class="max-w-2xl mx-auto">
    <form method="POST" class="space-y-6">

      <!-- Chat Title -->
      <div>
        <label for="chat_title" class="block text-lg font-medium text-gray-900 mb-4">
          Chat Title
        </label>
        <input
          type="text"
          id="chat_title"
          name="chat_title"
          class="w-full px-6 py-2 border border-gray-300 rounded-lg text-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
          placeholder="e.g. Science 2022 Batch"
          required
        />
      </div>
      
       <!--  Academic Level Field -->
        <div>
          <label for="academic_level" class="block text-lg font-medium text-gray-900 mb-4">
            Student's Academic Level
          </label>
          <select id="academic_level" name="academic_level" required
            class="w-full px-6 py-2 border border-gray-300 rounded-lg text-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none">
            <option value="">Select Student's Academic Level</option>
            <option value="elementary">Elementary (K-5)</option>
            <option value="middle">Middle School (6-8)</option>
            <option value="high">High School (9-12)</option>
            <option value="college">College/University</option>
            <option value="higher">Higher</option>
          </select>
        </div>

        <!-- Subject -->
        <div>
          <label for="subject" class="block text-lg font-medium text-gray-900 mb-4">
            Subject
          </label>
          <select id="subject" name="subject" required
            class="w-full px-6 py-2 border border-gray-300 rounded-lg text-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none">
            <option value="">Select Subject</option>
            <option value="mathematics">Mathematics</option>
            <option value="science">Science</option>
            <option value="biology">Biology</option>
            <option value="chemistry">Chemistry</option>
            <option value="physics">Physics</option>
            <option value="english">English/Language Arts</option>
            <option value="history">History/Social Studies</option>
            <option value="economics">Economics</option>
            <option value="arts">Arts & Music</option>
            <option value="computer science">Computer Science</option>
            <option value="other">Other</option>
          </select>
          
          <!-- Custom Subject Input (only shown when "Other" is selected) -->
          <div id="customSubjectContainer" class="mt-4 hidden">
            <label for="custom_subject" class="block text-lg font-medium text-gray-900 mb-2">
              Please specify your subject
            </label>
            <input
              type="text"
              id="custom_subject"
              name="custom_subject"
              class="w-full px-6 py-2 border border-gray-300 rounded-lg text-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
              placeholder="e.g. Philosophy, Economics, Psychology..."
            />
          </div>
        </div>

      <!-- Help Text -->
      <div class="mt-8 text-center sm:text-left">
        <p class="text-gray-600 text-base">
          Fill in the basic information above to get started with your personalized lesson planning assistant.
        </p>
        <p class="text-gray-500 text-sm mt-2">
          You can always modify these settings later in your chat session.
        </p>
      </div>
      

      <!-- Create New Chat Button -->
      <div class="flex justify-end pt-6">
        <button
          type="submit"
          class="btn"
        >
          Create New Chat
        </button>
      </div>
    </form>

  </div>
</div>

{% block scripts %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Auto-focus on first input
    const firstInput = document.getElementById('academic_level');
    if (firstInput) {
      firstInput.focus();
    }

    // Handle subject selection change
    const subjectSelect = document.getElementById('subject');
    const customSubjectContainer = document.getElementById('customSubjectContainer');
    const customSubjectInput = document.getElementById('custom_subject');

    if (subjectSelect && customSubjectContainer && customSubjectInput) {
      subjectSelect.addEventListener('change', function() {
        if (this.value === 'other') {
          customSubjectContainer.classList.remove('hidden');
          customSubjectInput.required = true;
          customSubjectInput.focus();
        } else {
          customSubjectContainer.classList.add('hidden');
          customSubjectInput.required = false;
          customSubjectInput.value = '';
        }
      });
    }

    // Add smooth animations and handle custom subject submission
    const form = document.querySelector('form');
    form.addEventListener('submit', function(e) {           
      const button = form.querySelector('button[type="submit"]');
      button.innerHTML = `
        <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white inline" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        Creating Chat...
      `;
      button.disabled = true;
    });

    // Enhanced form validation
    const inputs = form.querySelectorAll('input[required], select[required]');
    inputs.forEach(input => {
      input.addEventListener('blur', function() {
        if (!this.value.trim()) {
          this.classList.add('border-red-300', 'focus:border-red-500', 'focus:ring-red-500');
          this.classList.remove('border-gray-300', 'focus:border-blue-500', 'focus:ring-blue-500');
        } else {
          this.classList.remove('border-red-300', 'focus:border-red-500', 'focus:ring-red-500');
          this.classList.add('border-gray-300', 'focus:border-blue-500', 'focus:ring-blue-500');
        }
      });
    });
  });
</script>
{% endblock %}
{% endblock %}
